* Criteria는 너무 복잡하고 어렵다는 단점이 있음.
* QueryDSL은 코드로 작성해도 쉽고 간결하며 그 모양도 쿼리와 비슷하게 개발할 수 있음.
    * Criteria가 가지는 장점에 더해서 쉽고 단순함.
* QueryDSL은 이름 그대로 데이터를 조회하는 데 기능이 특화되어 있음.

# QueryDSL 설정

### 필요 라이브러리

* QueryDSL 라이브러리를 추가.

#### pom.xml 추가

```xml
<dependency>
    <groupId>com.querydsl</groupId>
    <artifactId>querydsl-apt</artifactId>
    <version>${querydsl.version}</version>
    <scope>provided</scope>
</dependency>

<dependency>
    <groupId>com.querydsl</groupId>
    <artifactId>querydsl-jpa</artifactId>
    <version>${querydsl.version}</version>
</dependency>
```

### 환경설정

* Criteria의 메타 모델처럼 엔티티를 기반으로 쿼리 타입이라는 쿼리용 클래스 생성.

#### 쿼리 타입 생성용 pom.xml 추가

```xml
<project>
<build>
    <plugins>
        <plugin>
            <groupId>com.mysema.maven</groupId>
            <artifactId>apt-maven-plugin</artifactId>
            <version>1.1.3</version>
            <executions>
                <execution>
                    <goals>
                        <goal>process</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>target/generated-sources/java</outputDirectory>
                        <processor>com.querydsl.apt.jpa.JPAAnnotationProcessor</processor>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        ...
    </plugins>
</build>
</project>
```

* 콘솔에서 mnv compile 입력시 outputDirectory에 지정한 target/generated-sources 위치에<br/>
  QMember.class처럼 Q로 시작하는 쿼리 타입을 생성.

<br/>

# 시작

#### QueryDSL 시작

```java
public void queryDSL() {
    EntityManager em = emf.createEntityManager();

    JPAQuery<Member> query = new JPAQuery<>(em);
    QMember qMember = new QMember("m"); //생성되는 JPQL의 별칭이 m
    
    List<Member> members = 
        query.from(qMember)
            .where(qMember.username.eq("유저1"))
            .orderBy(qMember.username.desc())
            .fetch();
}
```

1. 우선 com.querydsl.jpa.impl.JPAQuery 객체를 생성. (엔티티 매니저 생성자로 전달)
2. 쿼리 타입(Q)을 생성하고 생성자에 별칭을 전달. (JPQL에서 별칭으로 사용)
3. 그 다음 from, where, orderBy 사용.

### 기본 Q 생성

* 쿼리 타입(Q)은 사용하기 편리하도록 아래와 같이 기본 인스턴스 보관.
* 같은 엔티티를 조인하거나 서브쿼리에 사용하면 같은 별칭이 사용되므로 별칭을 직접 지정해서 사용 필요.

#### Member 쿼리 타입

```java
public class QMember extends EntityPathBase<Member> {
    public static final QMember member = new QMember("member1");
    ...
}

//쿼리 타입 사용
QMember qMember = new QMember("m"); //직접 지정
QMember qMember = QMember.member; //기본 인스턴스 사용
```

